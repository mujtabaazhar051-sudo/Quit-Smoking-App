<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Savings Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="lang-toggle"><button id="btn-ur" class="lang-btn">اردو</button><button id="btn-en" class="lang-btn">English</button></div>
  <section class="hero small-hero"><div class="hero-content"><h1 id="title">بچت کیلکولیٹر</h1><p id="subtitle">رقم اور سگریٹ کی بچت دیکھیں</p></div></section>

  <section class="app-section" style="max-width:640px;margin:auto;text-align:right">
    <label><strong id="cpdLbl">روزانہ سگریٹ:</strong></label>
    <input type="number" id="cigsPerDay" min="1" value="10" style="padding:8px;border-radius:6px;border:1px solid #ddd;margin:8px 0;width:100%">
    <label><strong id="priceLbl">پیکٹ قیمت (PKR):</strong></label>
    <input type="number" id="packPrice" min="1" value="400" style="padding:8px;border-radius:6px;border:1px solid #ddd;margin:8px 0;width:100%">
    <label><strong id="cppLbl">پیکٹ میں سگریٹ:</strong></label>
    <input type="number" id="cigsPerPack" min="1" value="20" style="padding:8px;border-radius:6px;border:1px solid #ddd;margin:8px 0;width:100%">
    <button class="cta-btn" id="calcBtn">حساب کریں</button>

    <div style="margin-top:14px;background:#fff;border-radius:8px;padding:14px;box-shadow:0 2px 8px rgba(0,0,0,.08)">
      <p><strong id="savedLbl">اب تک بچت:</strong> <span id="saved">PKR 0</span></p>
      <p><strong id="monthlyLbl">ماہانہ بچت:</strong> <span id="monthly">PKR 0</span></p>
      <p><strong id="avoidedLbl">بچائے گئے سگریٹ:</strong> <span id="avoided">0</span></p>
    </div>
  </section>

  <div style="text-align:center;margin:30px 0 60px"><a href="app.html" class="cta-btn" id="backApp">ایپ مینو</a></div>

  <script src="js/common.js"></script>
  <script>
    function applyCopy(){
      const ur=currentLang()==='ur';
      document.getElementById('title').textContent=ur?'بچت کیلکولیٹر':'Savings Calculator';
      document.getElementById('subtitle').textContent=ur?'رقم اور سگریٹ کی بچت دیکھیں':'See money and cigarettes saved';
      document.getElementById('cpdLbl').textContent=ur?'روزانہ سگریٹ:':'Cigarettes per day:';
      document.getElementById('priceLbl').textContent=ur?'پیکٹ قیمت (PKR):':'Price per pack (PKR):';
      document.getElementById('cppLbl').textContent=ur?'پیکٹ میں سگریٹ:':'Cigarettes per pack:';
      document.getElementById('calcBtn').textContent=ur?'حساب کریں':'Calculate';
      document.getElementById('savedLbl').textContent=ur?'اب تک بچت:':'Saved so far:';
      document.getElementById('monthlyLbl').textContent=ur?'ماہانہ بچت:':'Monthly saving:';
      document.getElementById('avoidedLbl').textContent=ur?'بچائے گئے سگریٹ:':'Cigarettes avoided:';
      document.getElementById('backApp').textContent=ur?'ایپ مینو':'App Menu';
      applyDirLang();
    }
    function calc(){
      const q = LS.get('quitDate','');
      const cpd = +document.getElementById('cigsPerDay').value || 0;
      const price = +document.getElementById('packPrice').value || 0;
      const cpp = +document.getElementById('cigsPerPack').value || 20;
      if(!q || !cpd || !price || !cpp) return;
      const days = Math.max(0, daysBetween(new Date(q+'T00:00:00'), new Date()));
      const avoided = days * cpd;
      const savedSoFar = avoided * (price/cpp);
      const monthly = 30 * cpd * (price/cpp);
      const loc = fmtLocale();
      document.getElementById('saved').textContent   = 'PKR ' + Math.round(savedSoFar).toLocaleString(loc);
      document.getElementById('monthly').textContent = 'PKR ' + Math.round(monthly).toLocaleString(loc);
      document.getElementById('avoided').textContent = avoided.toLocaleString(loc);
      LS.set('calc', { cigsPerDay:cpd, packPrice:price, cigsPerPack:cpp });
    }
    applyCopy(); hookLangButtons(applyCopy);
    const prev = LS.get('calc',null);
    if(prev){ cigsPerDay.value=prev.cigsPerDay||10; packPrice.value=prev.packPrice||400; cigsPerPack.value=prev.cigsPerPack||20; }
    document.getElementById('calcBtn').addEventListener('click', calc);
    // run once to display if quitDate exists
    calc();
  </script>
</body>
</html>
